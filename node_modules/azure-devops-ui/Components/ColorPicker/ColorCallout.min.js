import{__awaiter,__extends,__generator}from"tslib";import"../../CommonImports";import"../../Core/core.css";import"./ColorPicker.css";import*as React from"react";import{wait}from"../../Core/Util/Promise";import{Button}from"../../Button";import{Callout,ContentSize}from"../../Callout";import{FocusZone,FocusZoneDirection,FocusZoneKeyStroke}from"../../FocusZone";import{SimpleTableCell,Table}from"../../Table";import{css,KeyCode}from"../../Util";import{colorItems,colorRowProvider}from"./Utils";var ColorDropdownCalloutComponent=function(e){function o(){var o=null!==e&&e.apply(this,arguments)||this;return o._focusedColumn=0,o.renderCell=function(e,t,n,r,l){var i,c=r.cells[t],s=null===(i=o.props.selection)||void 0===i?void 0:i.value[0].beginIndex,d=c===colorItems[null!==s&&void 0!==s?s:0];return React.createElement(SimpleTableCell,{ariaRowIndex:l,columnIndex:t,key:t,tableColumn:n},React.createElement(Button,{id:e+"-"+t,className:css(d&&"bolt-dropdown-init-focus","color-button flex-grow"),style:{backgroundColor:"#"+c.id},tooltipProps:{text:c.text},onClick:function(e){var t,n=colorItems.findIndex(function(e){return e.id===c.id});n>=0&&(null===(t=o.props.selection)||void 0===t||t.select(n),o.props.onSelect&&o.props.onSelect(e,colorItems[n]),o.props.onDismiss())},onFocus:function(){return o._focusedColumn=t},onKeyDown:function(e){0===t&&e.which===KeyCode.leftArrow&&e.preventDefault()}}))},o.columns=[{id:"c1",renderCell:o.renderCell,width:-100/11},{id:"c2",renderCell:o.renderCell,width:-100/11},{id:"c3",renderCell:o.renderCell,width:-100/11},{id:"c4",renderCell:o.renderCell,width:-100/11},{id:"c5",renderCell:o.renderCell,width:-100/11},{id:"c6",renderCell:o.renderCell,width:-100/11},{id:"c7",renderCell:o.renderCell,width:-100/11},{id:"c8",renderCell:o.renderCell,width:-100/11},{id:"c9",renderCell:o.renderCell,width:-100/11},{id:"c10",renderCell:o.renderCell,width:-100/11},{id:"c11",renderCell:o.renderCell,width:-100/11}],o}return __extends(o,e),o.prototype.render=function(){var e=this,o=this.props,t=o.anchorElement,n=o.anchorOffset,r=o.anchorOrigin,l=o.anchorPoint,i=o.blurDismiss,c=void 0===i||i,s=o.calloutContentClassName,d=o.contentLocation,a=o.dropdownOrigin,u=o.excludeTabStop,m=o.id,p=o.lightDismiss,C=o.onFilterKeyDown,f=function(){e.props.onDismiss&&e.props.onDismiss()};return React.createElement(Callout,{anchorElement:t,anchorOffset:n,anchorOrigin:r,anchorPoint:l,blurDismiss:c,calloutOrigin:a,contentClassName:css(s,"bolt-dropdown flex-column custom-scrollbar v-scroll-auto h-scroll-hidden color-dropdown-callout"),contentLocation:d,contentShadow:!0,contentSize:ContentSize.Auto,escDismiss:!0,id:m,lightDismiss:p,focuszoneProps:{postprocessKeyStroke:function(e){return e.which!==KeyCode.tab||e.defaultPrevented?FocusZoneKeyStroke.IgnoreNone:(e.preventDefault(),f(),FocusZoneKeyStroke.IgnoreAll)}},onDismiss:f},React.createElement(FocusZone,{circularNavigation:!0,defaultActiveElement:".bolt-dropdown-init-focus",direction:FocusZoneDirection.Vertical,focusOnMount:!0},React.createElement("div",{className:"bolt-dropdown-container no-outline",onKeyDown:C},React.createElement("div",{"aria-hidden":"true",className:"no-outline",tabIndex:u?void 0:-1,role:"listbox"}),React.createElement(Table,{columns:this.columns,containerClassName:"color-dropdown-table-container",itemProvider:colorRowProvider,onFocus:function(o,t){return __awaiter(e,void 0,void 0,function(){var e,t,n;return __generator(this,function(r){switch(r.label){case 0:return e=o.nativeEvent,[4,wait(0)];case 1:return r.sent(),"TR"===e.target.tagName&&(t=e.target,(n=t.querySelector('td[data-column-index="'+this._focusedColumn+'"] button'))&&n!==document.activeElement&&n.focus()),[2]}})})}}))))},o}(React.Component);export{ColorDropdownCalloutComponent};