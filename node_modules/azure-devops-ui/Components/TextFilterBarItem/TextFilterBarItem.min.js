import{__assign,__extends}from"tslib";import"../../CommonImports";import"../../Core/core.css";import*as React from"react";import{Button}from"../../Button";import{FilterBarItem}from"../../FilterBarItem";import*as Resources from"../../Resources.Input";import{TextField,TextFieldFocusTreatmentBehavior}from"../../TextField";import{css,KeyCode}from"../../Util";var DEFAULT_MAX_TEXT_LENGTH=200,DEFAULT_THROTTLE_WAIT=200,TextFilterBarItem=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.textField=React.createRef(),t.onClickClearButton=function(e){t.setFilterValue({value:""}),t.textField.current&&t.textField.current.focus()},t.onTextChanged=function(e,r){t.setFilterValue({value:r})},t.onKeyDown=function(e){if(t.props.filter){switch(e.which){case KeyCode.enter:t.props.filter.setFilterItemState(t.props.filterItemKey,{value:t.state.value}),t.props.filter.applyChanges();break;case KeyCode.escape:t.setFilterValue({value:""}),t.setState({value:""}),t.props.filter.applyChanges();break;default:return}e.preventDefault(),e.stopPropagation()}},t}return __extends(t,e),t.prototype.focus=function(){if(this.textField.current)return this.textField.current.focus()},t.prototype.render=function(){var e=this,t=this.state.value,r=this.props,o=r.className,l=r.clearable,i=r.placeholder,a=r.maxTextLength,n=r.inputClassName,s=r.style,c=r.width,u={text:t||i,overflowOnly:!0,overflowDetected:this.overflowDetected},p=void 0;return l&&t&&(p={render:function(t){return React.createElement(Button,{ariaLabel:Resources.ClearFilter,className:css(t,"bolt-text-filterbaritem-clear"),iconProps:{iconName:"Cancel"},onClick:e.onClickClearButton})}}),React.createElement(TextField,__assign({ariaLabel:i,className:css(o,"bolt-text-filterbaritem flex-grow"),containerClassName:"flex-grow",inputClassName:css(n,"bolt-text-filterbaritem-input"),inputType:"text",focusTreatment:TextFieldFocusTreatmentBehavior.keyboardOnly,maxLength:a||DEFAULT_MAX_TEXT_LENGTH,onChange:this.onTextChanged,onKeyDown:this.onKeyDown,placeholder:i,ref:this.textField,style:s,suffixIconProps:p,value:t||"",width:c,tooltipProps:u},this.getExtraTextFieldProps()))},t.prototype.overflowDetected=function(e){var t=!0;if(e.value&&e.value.length>0)t=e.scrollWidth>e.clientWidth;else{var r=e.getAttribute("placeholder");e.value=r||"",t=e.scrollWidth>e.clientWidth,e.value=""}return t},t.prototype.getExtraTextFieldProps=function(){return null},t.prototype.getThrottleWait=function(){var e=this.props.throttleWait;return void 0===e?DEFAULT_THROTTLE_WAIT:e},t.defaultProps={isTextItem:!0},t}(FilterBarItem);export{TextFilterBarItem};